DEBUG: initialize called. _is_initialized=True
Traceback (most recent call last):
  File "/Users/dwickyferiansyahputra/Public/Research/compute-rst/tests/reproduce_snowflake_offset.py", line 114, in <module>
    run_test()
  File "/Users/dwickyferiansyahputra/Public/Research/compute-rst/tests/reproduce_snowflake_offset.py", line 110, in run_test
    test.test_sync_execution()
  File "/Users/dwickyferiansyahputra/Public/Research/compute-rst/tests/reproduce_snowflake_offset.py", line 74, in test_sync_execution
    count = self.destination.write_batch(records, table_sync)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dwickyferiansyahputra/Public/Research/compute-rst/compute/destinations/snowflake/destination.py", line 418, in write_batch
    future = asyncio.run_coroutine_threadsafe(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 950, in run_coroutine_threadsafe
    loop.call_soon_threadsafe(callback)
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'call_soon_threadsafe'
sys:1: RuntimeWarning: coroutine 'SnowflakeDestination._write_batch_async' was never awaited
